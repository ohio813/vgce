Replays are MPQ archives containing various pieces of data.

REPLAY.GAME.EVENTS
  Contains the game events (select, order, right click, etc).

REPLAY.INFO
  Contains header information.

  struct replayInfo
  {
    u8     playerCount;
    struct playerHead
    {
      u8    length;
      char  name[length]
      u8    unknown;  // padding I guess?
      u32   unknown;
    }     players[playerCount];
    
    u8    unknown1;
    u32   unknown2;
    u8    gtLen;
    char  gameType[gtLen];  // This is only a guess
    u8    unknown3;
    u8    unknown4;
    u8    unknown5;   // This value must be <= 4
    u16   unknown6;
    u32   unknown7;
    u32   unknown8;
    u8    unknown9;   // This value must be <= 0x1F
    u8    mapLen;
    char  mapFileName[mapLen];
    u32   unknown10;
    u16   unknown11;    // This value must be 0
    u16   unknown12;
    u8    unknown13;
    u8    unknown14;    // This value must be <= 7
    u16   unknown15;    // This value must be <= 0xBB
    
    ... /* Unknown. Assuming map/game settings. */
    
    char[]  mapTitle;
    u8      playerDisplayCount;
    struct  playerDisplay
    {
      u8    nameLen;
      char  playerName[nameLen];
      u8    raceLen;
      char  raceName[raceLen];
      u8    colorLen;
      char  color[colorLen];  // Format is "a,r,g,b"; a is unused
    }   displayPlayers[playerDisplayCount]
  }

REPLAY.MESSAGE.EVENTS
  Contains information from chat messages and other non-game impact commands.
  
REPLAY.SMARTCAM.EVENTS
  Assuming camera data for first-person replays.

REPLAY.SYNC.EVENTS
  Assuming this file maintains synchronization for more reliable data.

SAVE.JPG
  A preview of the map that was played on.